<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component Snapshot Test Page</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .section {
            margin-bottom: 40px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section h2 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .chart-container {
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            position: relative;
            transition: all 0.3s ease;
        }
        .chart-container h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #555;
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table th {
            background-color: #007bff;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        table td {
            padding: 10px 12px;
            border-bottom: 1px solid #ddd;
        }
        table tr:hover {
            background-color: #f8f9fa;
        }
        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .zoomed {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 9999 !important;
            margin: 0 !important;
            padding: 20px !important;
            background: white !important;
            border-radius: 0 !important;
            box-shadow: none !important;
        }
        .zoomed .chart-wrapper {
            height: calc(100vh - 100px) !important;
        }
        #status {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #28a745;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 14px;
            z-index: 10000;
        }
    </style>
</head>
<body>
    <div id="status">Ready for snapshots</div>
    
    <div class="container">
        <h1>Component Snapshot Test Page</h1>
        <p>This page contains multiple components for testing the snapshot service.</p>

        <!-- Pie Charts Section -->
        <div class="section">
            <h2>Pie Charts</h2>
            <div class="charts-grid">
                <div class="chart-container" id="pie-chart-1">
                    <h3>Sales by Region</h3>
                    <div class="chart-wrapper">
                        <canvas id="pieCanvas1"></canvas>
                    </div>
                </div>
                <div class="chart-container" id="pie-chart-2">
                    <h3>Market Share</h3>
                    <div class="chart-wrapper">
                        <canvas id="pieCanvas2"></canvas>
                    </div>
                </div>
                <div class="chart-container" id="pie-chart-3">
                    <h3>Product Categories</h3>
                    <div class="chart-wrapper">
                        <canvas id="pieCanvas3"></canvas>
                    </div>
                </div>
                <div class="chart-container" id="pie-chart-4">
                    <h3>Customer Segments</h3>
                    <div class="chart-wrapper">
                        <canvas id="pieCanvas4"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bar Charts Section -->
        <div class="section">
            <h2>Bar Charts</h2>
            <div class="charts-grid">
                <div class="chart-container" id="bar-chart-1">
                    <h3>Monthly Revenue</h3>
                    <div class="chart-wrapper">
                        <canvas id="barCanvas1"></canvas>
                    </div>
                </div>
                <div class="chart-container" id="bar-chart-2">
                    <h3>Quarterly Growth</h3>
                    <div class="chart-wrapper">
                        <canvas id="barCanvas2"></canvas>
                    </div>
                </div>
                <div class="chart-container" id="bar-chart-3">
                    <h3>Department Performance</h3>
                    <div class="chart-wrapper">
                        <canvas id="barCanvas3"></canvas>
                    </div>
                </div>
                <div class="chart-container" id="bar-chart-4">
                    <h3>Year-over-Year Comparison</h3>
                    <div class="chart-wrapper">
                        <canvas id="barCanvas4"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tables Section -->
        <div class="section">
            <h2>Data Tables</h2>
            
            <div class="chart-container" id="table-1" style="margin-bottom: 20px;">
                <h3>Sales Performance Summary</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Region</th>
                            <th>Q1 Sales</th>
                            <th>Q2 Sales</th>
                            <th>Q3 Sales</th>
                            <th>Q4 Sales</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>North America</td>
                            <td>$1,245,000</td>
                            <td>$1,456,000</td>
                            <td>$1,678,000</td>
                            <td>$1,890,000</td>
                            <td>$6,269,000</td>
                        </tr>
                        <tr>
                            <td>Europe</td>
                            <td>$985,000</td>
                            <td>$1,123,000</td>
                            <td>$1,234,000</td>
                            <td>$1,456,000</td>
                            <td>$4,798,000</td>
                        </tr>
                        <tr>
                            <td>Asia Pacific</td>
                            <td>$1,567,000</td>
                            <td>$1,789,000</td>
                            <td>$1,923,000</td>
                            <td>$2,145,000</td>
                            <td>$7,424,000</td>
                        </tr>
                        <tr>
                            <td>Latin America</td>
                            <td>$456,000</td>
                            <td>$523,000</td>
                            <td>$589,000</td>
                            <td>$678,000</td>
                            <td>$2,246,000</td>
                        </tr>
                        <tr>
                            <td>Middle East</td>
                            <td>$234,000</td>
                            <td>$345,000</td>
                            <td>$412,000</td>
                            <td>$489,000</td>
                            <td>$1,480,000</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="chart-container" id="table-2">
                <h3>Product Inventory Status</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Product ID</th>
                            <th>Product Name</th>
                            <th>Category</th>
                            <th>In Stock</th>
                            <th>On Order</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>PRD-001</td>
                            <td>Widget Pro</td>
                            <td>Hardware</td>
                            <td>1,245</td>
                            <td>500</td>
                            <td>✓ Available</td>
                        </tr>
                        <tr>
                            <td>PRD-002</td>
                            <td>Software Suite X</td>
                            <td>Software</td>
                            <td>Unlimited</td>
                            <td>-</td>
                            <td>✓ Available</td>
                        </tr>
                        <tr>
                            <td>PRD-003</td>
                            <td>Enterprise License</td>
                            <td>License</td>
                            <td>45</td>
                            <td>20</td>
                            <td>⚠ Low Stock</td>
                        </tr>
                        <tr>
                            <td>PRD-004</td>
                            <td>Premium Support</td>
                            <td>Service</td>
                            <td>-</td>
                            <td>-</td>
                            <td>✓ Available</td>
                        </tr>
                        <tr>
                            <td>PRD-005</td>
                            <td>Cloud Storage 1TB</td>
                            <td>Service</td>
                            <td>850</td>
                            <td>200</td>
                            <td>✓ Available</td>
                        </tr>
                        <tr>
                            <td>PRD-006</td>
                            <td>Training Package</td>
                            <td>Education</td>
                            <td>12</td>
                            <td>0</td>
                            <td>⚠ Low Stock</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Initialize window.application object
        window.application = {};

        // Store original states for restoration
        let zoomedElement = null;
        let originalStyles = {};

        // Implement zoomComponent function
        window.application.zoomComponent = function(componentId, zoom) {
            console.log('zoomComponent called:', componentId, zoom);
            
            if (!componentId || typeof componentId !== 'string') {
                console.error('Invalid componentId:', componentId);
                return;
            }

            const element = document.getElementById(componentId);

            if (!element) {
                console.error('Component not found:', componentId);
                return;
            }

            if (zoom) {
                // Restore any previously zoomed element
                if (zoomedElement && zoomedElement !== element) {
                    zoomedElement.classList.remove('zoomed');
                    if (originalStyles[zoomedElement.id]) {
                        Object.assign(zoomedElement.style, originalStyles[zoomedElement.id]);
                    }
                }

                // Save original styles
                originalStyles[componentId] = {
                    position: element.style.position,
                    top: element.style.top,
                    left: element.style.left,
                    width: element.style.width,
                    height: element.style.height,
                    zIndex: element.style.zIndex,
                    margin: element.style.margin,
                    padding: element.style.padding,
                    background: element.style.background,
                    borderRadius: element.style.borderRadius,
                    boxShadow: element.style.boxShadow
                };

                // Apply zoom
                element.classList.add('zoomed');
                zoomedElement = element;

                // Scroll to top to ensure it's visible
                window.scrollTo(0, 0);

                console.log('Component zoomed:', componentId);
            } else {
                // Restore original state
                element.classList.remove('zoomed');
                if (originalStyles[componentId]) {
                    Object.assign(element.style, originalStyles[componentId]);
                }
                zoomedElement = null;
                
                // Scroll to element in its normal position
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                console.log('Component unzoomed:', componentId);
            }

            return true;
        };

        // Create Pie Charts
        function createPieChart(canvasId, label, data, colors) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: label,
                        data: data.values,
                        backgroundColor: colors,
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                        },
                        title: {
                            display: false
                        }
                    }
                }
            });
        }

        // Create Bar Charts
        function createBarChart(canvasId, label, data, color) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: label,
                        data: data.values,
                        backgroundColor: color,
                        borderColor: color,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Initialize all charts when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Pie Chart 1: Sales by Region
            createPieChart('pieCanvas1', 'Sales by Region',
                {
                    labels: ['North America', 'Europe', 'Asia Pacific', 'Latin America', 'Middle East'],
                    values: [6269, 4798, 7424, 2246, 1480]
                },
                ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
            );

            // Pie Chart 2: Market Share
            createPieChart('pieCanvas2', 'Market Share',
                {
                    labels: ['Product A', 'Product B', 'Product C', 'Product D', 'Others'],
                    values: [35, 25, 20, 12, 8]
                },
                ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
            );

            // Pie Chart 3: Product Categories
            createPieChart('pieCanvas3', 'Product Categories',
                {
                    labels: ['Hardware', 'Software', 'Services', 'Licenses', 'Support'],
                    values: [28, 32, 18, 15, 7]
                },
                ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
            );

            // Pie Chart 4: Customer Segments
            createPieChart('pieCanvas4', 'Customer Segments',
                {
                    labels: ['Enterprise', 'SMB', 'Startup', 'Government', 'Education'],
                    values: [42, 28, 15, 10, 5]
                },
                ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
            );

            // Bar Chart 1: Monthly Revenue
            createBarChart('barCanvas1', 'Revenue (thousands)',
                {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    values: [1245, 1356, 1478, 1589, 1678, 1789, 1856, 1923, 2045, 2156, 2267, 2378]
                },
                'rgba(54, 162, 235, 0.7)'
            );

            // Bar Chart 2: Quarterly Growth
            createBarChart('barCanvas2', 'Growth %',
                {
                    labels: ['Q1 2023', 'Q2 2023', 'Q3 2023', 'Q4 2023', 'Q1 2024', 'Q2 2024'],
                    values: [12, 15, 18, 22, 25, 28]
                },
                'rgba(75, 192, 192, 0.7)'
            );

            // Bar Chart 3: Department Performance
            createBarChart('barCanvas3', 'Performance Score',
                {
                    labels: ['Sales', 'Marketing', 'Engineering', 'Support', 'Operations', 'HR'],
                    values: [92, 88, 95, 87, 90, 85]
                },
                'rgba(153, 102, 255, 0.7)'
            );

            // Bar Chart 4: Year-over-Year Comparison
            createBarChart('barCanvas4', 'Revenue (millions)',
                {
                    labels: ['2019', '2020', '2021', '2022', '2023', '2024'],
                    values: [45, 52, 68, 85, 102, 125]
                },
                'rgba(255, 159, 64, 0.7)'
            );

            console.log('All components initialized and ready for snapshot testing');
        });
    </script>
</body>
</html>
